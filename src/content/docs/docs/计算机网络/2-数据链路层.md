---
title: 数据链路层
---
## 信道访问协议
主要包括三个内容，TDMA/CDMA（分时、分码） 信道划分协议，CSMA载波侦听多路访问。

---

### TDMA（Time Division Multiple Access，时分多址）
**核心思想：按时间划分信道**

在 TDMA 中，时间被划分为一系列周期性重复的时间片，每个用户被分配一个或多个时间片，在其时间片内独占使用整个信道。

优点：

+ **无干扰**：同一时刻只有一个用户使用信道，避免碰撞；
+ **同步容易管理**：适合同步的系统，如蜂窝网络、卫星通信；
+ **能量可控**：设备只在特定时间段发送数据，有利于节能（尤其在移动通信中）；

缺点：

+ **需要精确同步**：对时钟同步要求高；
+ **带宽利用率较低**：当用户没有数据传输时，分配给其的时隙就被浪费。

应用：GSM（2G移动通信）、某些卫星通信系统。

---

### CDMA（Code Division Multiple Access，码分多址）
**核心思想：按“码”划分信道**

在 CDMA 中，所有用户在**同一时间**、**同一频率带宽**上传输数据，但每个用户使用**不同的伪随机码（扩频码）**将数据扩频。接收端通过对应的解扩码来恢复原始信号。

优点：

+ **抗干扰能力强**：码字正交，能抑制其他用户的干扰；
+ **频谱利用率高**：多个用户共享整个频段；
+ **隐私性强**：只有知道码字的人才能解码信息；
+ **无须精确时间同步**：比TDMA对时钟同步要求低一些。

缺点：

+ **码字设计复杂**：需要高度正交的伪码；
+ **实现复杂**：扩频和解扩计算量大；
+ **受“近远效应”影响大**：如果靠近的用户信号过强，会干扰远处用户（需要引入功率控制）。

应用：CDMA2000、WCDMA、3G移动通信、GPS（全球定位系统）。

---

### CSMA（Carrier Sense Multiple Access，载波侦听多路访问）
**核心思想：先听信道，再决定是否发送**

CSMA 属于**随机接入协议**，通常用于局域网（如以太网）。它的工作方式是：发送方先监听信道是否空闲（载波侦听），若空闲就发送，否则等待一段时间后重试。

常见变种：

+ **CSMA/CD（带冲突检测）**：以太网经典方式，检测到冲突就停止发送，等待随机退避时间再重发；
+ **CSMA/CA（带冲突避免）**：无线局域网（如Wi-Fi）常用，通过请求发送/清除发送等机制来减少冲突（因为无法检测冲突）；

优点：

+ **实现简单，适用于动态网络**；
+ **适合突发性通信**，带宽利用率高。

缺点：

+ **碰撞不可完全避免**（尤其在载波传播延迟较大的系统中）；
+ **在网络拥塞时性能急剧下降**；
+ **无线网络中无法做冲突检测（因半双工），只能尝试避免（CA）**。

应用：以太网（CSMA/CD）、Wi-Fi（CSMA/CA）。

---

### 总结对比
| 协议 | 划分方式 | 是否同步 | 干扰情况 | 应用场景 |
| --- | --- | --- | --- | --- |
| TDMA | 按时间分 | 是 | 少（不同时传输） | GSM、卫星通信 |
| CDMA | 按码分 | 可异步 | 好（码间干扰小） | 3G、GPS |
| CSMA | 无划分，随机接入 | 否 | 高（可能碰撞） | 局域网、Wi-Fi |


---

## 组帧
组帧的知识点主要围绕如何进行数据帧的封装与解析，确保通信双方可以准确识别帧的起止和内容，主要包括帧定界、透明传输和几种封帧方法。

在帧定界方面，核心问题是如何让接收方确定一帧的边界。为此需要一种“定界”机制。在透明传输中，接收方需要去除定界符以外的附加信息，还原原始数据。为了实现这一点，封帧方式的设计要能兼顾可靠性和透明性。

常见的封帧方式有多种：

+ 字节计数法：通过在帧头中标明数据段的字节数来确定帧的长度，但一旦字节数字段出错，整个帧就无法识别边界；
+ 字节填充法：是在帧的起止标志符之间使用特定字符，如SOH表示帧头、EOT表示帧尾，如果数据中本身包含这些特殊字符，就需要在前面插入转义字符ESC，接收方则进行“去转义”处理；
+ 零比特填充法：用位填充的方式，比如HDLC和PPP协议就采用这种方法，规则是在数据中每出现连续五个1时发送方就填充一个0，接收方在接收时则删除该0；
+ 违反编码法：使用“非法编码”来标识帧的开始或结束，适用于曼彻斯特编码等物理层可识别编码异常的场景。

整体来看，各种方法的设计都是为了解决帧边界识别和数据还原的问题，透明性和误码容忍度是重要的考量因素。

---

## 差错控制
### 1.检错编码      
循环冗余校验码（CRC）

![](https://cdn.nlark.com/yuque/0/2025/jpeg/57074993/1748255119364-1f496f54-dcf2-4485-bc9a-614a604a2e73.jpeg)



奇偶校验码 

### 2.纠错编码
海明码

---

## 流量控制
1.停止等待协议

![](https://cdn.nlark.com/yuque/0/2025/png/57074993/1748243747193-a5a67e7d-609e-4c6a-9250-76909cdda535.png)

2.后退n帧协议

![](https://cdn.nlark.com/yuque/0/2025/png/57074993/1748243734516-f1ec8bee-0ed1-437e-a846-5e8188892e31.png)

3.选择重传协议

![](https://cdn.nlark.com/yuque/0/2025/png/57074993/1748243718759-989efc03-2bc9-4f42-8bfd-f8899efd2220.png)

---

## 介质访问控制
1.ALOHA协议（古老1999）

![](https://cdn.nlark.com/yuque/0/2025/png/57074993/1748243780986-b5c90c98-c39f-459f-a97b-69617b0e5f02.png)

2.CSMA

![](https://cdn.nlark.com/yuque/0/2025/png/57074993/1748243811264-2102019e-436c-4815-a077-427ebee1f6bd.png)

3.CSMA/CD（冲突检测）

![](https://cdn.nlark.com/yuque/0/2025/png/57074993/1748243827438-a48ff113-d98e-4615-85d0-b6b686f4f222.png)

4.CSMA/CA（冲突避免）

---

# ARP
<font style="color:rgba(0, 0, 0, 0.85);">地址解析协议</font>

<font style="color:rgba(0, 0, 0, 0.85);">作用：</font>**<font style="color:rgb(0, 0, 0) !important;">将 IP 地址映射为对应的物理地址（MAC 地址）</font>**<font style="color:rgba(0, 0, 0, 0.85);">，实现网络层（IP）与数据链路层（MAC）的地址转换。通过ARP协议查询一个ip的MAC地址。</font>

<font style="color:rgba(0, 0, 0, 0.85);">原理工作过程：</font>

##### **<font style="color:rgb(0, 0, 0) !important;">1. 准备阶段：检查本地 ARP 缓存</font>**
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">主机 A 需要向主机 B（IP 地址为 IP_B）发送数据时，先查看自己的</font>**<font style="color:rgb(0, 0, 0) !important;">ARP 缓存表</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">（存储 IP-MAC 映射关系的本地数据库）。</font>
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">若缓存中存在 IP_B 对应的 MAC 地址（MAC_B），则直接使用该 MAC 地址封装数据帧，无需发起 ARP 请求。</font>
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">若缓存中无 IP_B 的映射，则进入下一步。</font>

##### **<font style="color:rgb(0, 0, 0) !important;">2. 广播发送 ARP 请求报文</font>**
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">主机 A 构造一个</font>**<font style="color:rgb(0, 0, 0) !important;">ARP 请求报文</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">，内容包括：</font>
    - <font style="color:rgba(0, 0, 0, 0.85) !important;">源 IP 地址：主机 A 的 IP。</font>
    - <font style="color:rgba(0, 0, 0, 0.85) !important;">源 MAC 地址：主机 A 的 MAC。</font>
    - <font style="color:rgba(0, 0, 0, 0.85) !important;">目标 IP 地址：主机 B 的 IP。</font>
    - <font style="color:rgba(0, 0, 0, 0.85) !important;">目标 MAC 地址：全 0（或 FF:FF:FF:FF:FF:FF，广播地址）。</font>
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">主机 A 将 ARP 请求以</font>**<font style="color:rgb(0, 0, 0) !important;">广播形式</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">发送到所在局域网（所有设备都会收到该报文）。</font>

##### **<font style="color:rgb(0, 0, 0) !important;">3. 局域网设备接收并处理请求</font>**
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">所有收到 ARP 请求的设备会检查报文中的 “目标 IP 地址”：</font>
    - <font style="color:rgba(0, 0, 0, 0.85) !important;">若目标 IP 不是自己的 IP，则忽略该请求。</font>
    - <font style="color:rgba(0, 0, 0, 0.85) !important;">若是自己的 IP（如主机 B），则执行以下操作：</font>
        1. <font style="color:rgba(0, 0, 0, 0.85) !important;">将主机 A 的 IP和 MAC存入自己的 ARP 缓存（更新或添加映射）。</font>
        2. <font style="color:rgba(0, 0, 0, 0.85) !important;">构造</font>**<font style="color:rgb(0, 0, 0) !important;">ARP 响应报文</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">，内容包括：</font>
            + <font style="color:rgba(0, 0, 0, 0.85) !important;">源 IP 地址：主机 B 的 IP。</font>
            + <font style="color:rgba(0, 0, 0, 0.85) !important;">源 MAC 地址：主机 B 的 MAC。</font>
            + <font style="color:rgba(0, 0, 0, 0.85) !important;">目标 IP 地址：主机 A 的 IP。</font>
            + <font style="color:rgba(0, 0, 0, 0.85) !important;">目标 MAC 地址：主机 A 的 MAC。</font>
        3. <font style="color:rgba(0, 0, 0, 0.85) !important;">将 ARP 响应以</font>**<font style="color:rgb(0, 0, 0) !important;">单播形式</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">发送给主机 A（因为报文中有主机 A 的 MAC 地址，可直接定位）。</font>

##### **<font style="color:rgb(0, 0, 0) !important;">4. 主机 A 接收 ARP 响应并更新缓存</font>**
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">主机 A 收到主机 B 的 ARP 响应后，从报文中提取 IP_B 对应的 MAC_B，存入自己的 ARP 缓存。</font>
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">后续向主机 B 发送数据时，直接使用缓存中的 MAC_B 封装数据帧，无需再次发起 ARP 请求。</font>

##### **<font style="color:rgb(0, 0, 0) !important;">5. ARP 缓存的更新与老化机制</font>**
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">ARP 缓存中的映射关系有</font>**<font style="color:rgb(0, 0, 0) !important;">老化时间</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">（通常为几分钟到几小时，不同系统可配置），超时后自动删除，以适应网络中设备的变动（如主机更换网卡、IP 变更等）。</font>
+ <font style="color:rgba(0, 0, 0, 0.85) !important;">若主机的 IP 或 MAC 发生变化，会通过新的 ARP 请求 / 响应更新网络中其他设备的缓存。</font>

![](https://cdn.nlark.com/yuque/0/2025/png/57074993/1748254047481-1763884e-5fde-4767-90d5-d7141120be0c.png)

---

## LAN VS VLAN
局域网（在一定物理区域内，将多台设备有线或无线连接<font style="color:rgba(0, 0, 0, 0.85);">实现资源共享和数据通信的网络系统）</font>与虚拟局域网（<font style="color:rgba(0, 0, 0, 0.85);">是一种通过软件技术将物理局域网（LAN）划分为多个逻辑上的虚拟子网的技术）</font>

<font style="color:rgba(0, 0, 0, 0.85);">典型的LAN：</font>

+ **<font style="color:rgb(0, 0, 0) !important;">以太网（Ethernet）</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">：最主流的 LAN 技术，基于 IEEE 802.3 标准，通过双绞线或光纤传输数据。</font>
+ **<font style="color:rgb(0, 0, 0) !important;">Wi-Fi（无线局域网）</font>**<font style="color:rgba(0, 0, 0, 0.85) !important;">：基于 IEEE 802.11 标准，通过无线信号实现设备互联。</font>

<font style="color:rgba(0, 0, 0, 0.85);"></font>

![](https://cdn.nlark.com/yuque/0/2025/png/57074993/1748244432196-31bcd3d9-db9c-4053-8506-dd5a6f12e8dd.png)

VLAN是LAN下分的虚拟广播地址

设计VLAN解决LAN的

1.**<font style="color:rgb(0, 0, 0) !important;">广播域过大导致性能下降</font>**

**<font style="color:rgb(0, 0, 0) !important;">2.物理位置限制导致管理低效</font>**

**<font style="color:rgb(0, 0, 0) !important;"></font>**

---

## <font style="color:rgb(0, 0, 0) !important;">MPLS</font>
多协议标签交换

<font style="color:rgba(0, 0, 0, 0.85);">是一种在网络层（三层）与数据链路层（二层）之间的 “中间层” 技术，通过为数据包添加 “标签（Label）”，实现基于标签的快速转发，而非传统 IP 网络中的逐跳路由查找。</font>

---

## <font style="color:rgba(0, 0, 0, 0.85);">相关设备和技术</font>
主要包括以太网、交换机、路由器。

---

### 以太网（Ethernet）
**概念**：以太网是一种**局域网（LAN）通信技术标准**，定义了物理层和数据链路层如何进行数据传输。

**主要使用方式**：采用**CSMA/CD**（载波监听多路访问/碰撞检测）机制；

**工作层次**：主要涵盖 **OSI模型的第1层（物理层）和第2层（数据链路层）**；

**传输单位**：数据帧（Ethernet Frame）；

**地址识别**：使用 **MAC地址（物理地址）**。

---

### 交换机（Switch）
**功能**：交换机是一个智能的二层网络设备，主要用于**转发局域网内部的数据包**。

**工作层次**：OSI模型第 **2层（数据链路层）**；

**工作原理：依据MAC地址学习与转发**，交换机会维护一个 **MAC地址表**，根据目标MAC地址将数据帧转发到正确端口；

交换机的典型特点有：

+ **广播隔离较弱**：默认所有端口在同一个广播域（除非用VLAN）；
+ **端口隔离能力强**：点对点通信互不干扰，效率高；
+ **无需配置，插上即用**。

典型应用：

+ 局域网内多个设备互联；
+ 公司、学校等小型网络的内部通信；
+ 用于连接电脑、打印机、服务器等局域网设备。

---

### 路由器（Router）
**功能**：路由器是实现不同网络之间互联的设备，能够**根据IP地址**进行**路径选择和转发**。

**工作层次**：OSI模型第 **3层（网络层）**；

工作原理：**依据IP地址转发数据包**，维护路由表，决定数据包从哪条路径走；

几个典型特点是：

+ **隔离广播域**：连接的每个接口属于不同的子网，广播无法跨越；
+ **可实现网络地址转换（NAT）**，常用于内网访问外网；
+ **具备安全功能**：如防火墙、访问控制列表（ACL）等。

典型应用：

+ 家庭宽带路由器（连接运营商网络）；
+ 企业网络出口；
+ 实现多个子网之间通信；
+ 跨网络转发数据包（比如从192.168.1.x传到10.0.0.x）；

---

### 设备场景整理
| 场景 | 使用设备 | 原因 |
| --- | --- | --- |
| 多台电脑互联，组建局域网 | 交换机 | 提供高效的二层通信 |
| 不同网段之间通信 | 路由器 | 需要三层转发能力 |
| 上网连接公网 | 路由器 | 提供NAT与IP转发 |
| 公司内部多个部门隔离通信 | VLAN + 交换机 + 路由器 | VLAN隔离，路由器实现跨VLAN通信 |
| 家庭网络 | 路由器（含交换机功能） | 家用路由器通常集成交换功能，插口多个 |


---

### OSI七层模型下的对应
| OSI层 | 设备示例 | 描述 |
| --- | --- | --- |
| 第1层 物理层 | 集线器（Hub） | 转发电信号，不做处理（已淘汰） |
| 第2层 数据链路层 | 交换机（Switch） | 依据MAC地址转发帧 |
| 第3层 网络层 | 路由器（Router） | 依据IP地址选择路由路径 |


